<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VITOOSH ARTWORKS</title>
  <meta name="description" content="VITOOSH ARTWORKS — portfolio gallery">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="header">
    <a href="index.html"><img id="logo" class="logo" src="assets/logo/logo.png" alt="VITOOSH Logo"></a>

    <nav>
      <div class="dropdown" id="projectsDropdown">
        <div class="dropdown-toggle" id="projectsToggle">Projects ▾</div>
        <div class="dropdown-menu" id="projectsMenu">
          <a href="projects/commissions.html">Commissions</a>
          <a href="projects/2025.html">2025</a>
          <a href="projects/2024.html">2024</a>
          <a href="projects/2023.html">2023</a>
        </div>
      </div>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
    </nav>
  </header>

  <main class="container">
    <section id="gallery" class="gallery" aria-live="polite"></section>
  </main>

  <!-- lightbox -->
  <div id="lightbox" class="lb" role="dialog" aria-hidden="true">
    <button class="close" id="lbClose" aria-label="Close">✕</button>
    <img id="lbImage" src="" alt="Artwork">
  </div>

  <footer>
    <div class="footer-inner">
      <div>© <span id="year"></span> VITOOSH ARTWORKS</div>
      <a class="icon-btn" href="https://instagram.com/vitoosh" target="_blank" rel="noopener noreferrer" title="Instagram">
        <!-- simple instagram icon -->
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7zm5 3.5A4.5 4.5 0 1 1 7.5 12 4.5 4.5 0 0 1 12 7.5zm0 2A2.5 2.5 0 1 0 14.5 12 2.5 2.5 0 0 0 12 9.5zM18.5 6a.75.75 0 1 1 0 1.5A.75.75 0 0 1 18.5 6z"/>
        </svg>
      </a>
    </div>
  </footer>

  <script>
  const repo = "vitoosh/vitooshartwork";

  // --- Projects dropdown toggle ---
  const projectsToggle = document.getElementById('projectsToggle');
  const projectsMenu = document.getElementById('projectsMenu');
  document.addEventListener('click', (e) => {
    if (projectsToggle.contains(e.target)) {
      projectsMenu.style.display =
        projectsMenu.style.display === 'block' ? 'none' : 'block';
    } else if (!projectsMenu.contains(e.target)) {
      projectsMenu.style.display = 'none';
    }
  });

  // --- Lightbox ---
  const lb = document.getElementById('lightbox');
  const lbImg = document.getElementById('lbImage');
  const lbClose = document.getElementById('lbClose');
  function openLightbox(src) {
    lbImg.src = src;
    lb.classList.add('open');
    lb.setAttribute('aria-hidden', 'false');
  }
  function closeLightbox() {
    lb.classList.remove('open');
    lb.setAttribute('aria-hidden', 'true');
  }
  lbClose.addEventListener('click', closeLightbox);
  lb.addEventListener('click', (e) => { if (e.target === lb) closeLightbox(); });
  document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeLightbox(); });

  // --- Fetch artworks from GitHub ---
  async function fetchFolderContents(path) {
    const res = await fetch(`https://api.github.com/repos/${repo}/contents/${path}`);
    if (!res.ok) throw new Error('Failed to load ' + path);
    return res.json();
  }

  async function collectAllArtworks() {
    const rootPath = 'assets/artworks';
    const collected = [];
    const seen = new Set(); // to avoid duplicates

    async function explore(path) {
  const entries = await fetchFolderContents(path);
  const excludeFolders = ['2023', 'commissions']; // folders to skip at root level

  for (const entry of entries) {
    if (entry.type === 'dir') {
      // Skip excluded folders only at the top level of 'assets/artworks'
      if (!(path === 'assets/artworks' && excludeFolders.includes(entry.name))) {
        await explore(entry.path);
      }
    } else if (entry.type === 'file' && !seen.has(entry.name)) {
      seen.add(entry.name);
      collected.push(entry);
    }
  }
}

    try {
      await explore(rootPath);
    } catch (e) {
      console.error(e);
    }
    return collected;
  }

  function renderGallery(items, container) {
    container.innerHTML = '';
    items.forEach(file => {
      const ext = file.name.split('.').pop().toLowerCase();
      if (!/^(jpg|jpeg|png|gif|webp)$/.test(ext)) return;
      const div = document.createElement('div');
      div.className = 'item';
      const img = document.createElement('img');
      img.src = file.download_url;
      img.alt = file.name.replace(/[-_]/g, ' ').replace(/\.[^/.]+$/, '');
      img.loading = 'lazy';
      img.addEventListener('click', () => openLightbox(file.download_url));
      div.appendChild(img);
      container.appendChild(div);
    });
  }

  (async () => {
    document.getElementById('year').textContent = new Date().getFullYear();
    const galleryEl = document.getElementById('gallery');
    const files = await collectAllArtworks();
    if (!files || files.length === 0) {
      galleryEl.innerHTML = '<p style="color:#666;text-align:center">No artworks yet.</p>';
    } else {
      renderGallery(files, galleryEl);
    }
  })();

  // --- Disable right-click, drag, and certain shortcuts ---
document.addEventListener('contextmenu', function (e) {
  if (e.target.tagName === 'IMG') {
    e.preventDefault();
    showCopyrightMessage();
  }
});

document.addEventListener('dragstart', function (e) {
  if (e.target.tagName === 'IMG') e.preventDefault();
});

document.addEventListener('keydown', function (e) {
  if ((e.ctrlKey || e.metaKey) && ['s', 'u', 'p'].includes(e.key.toLowerCase())) {
    e.preventDefault();
    showCopyrightMessage();
  }
});

// --- Copyright overlay ---
function showCopyrightMessage() {
  // Prevent multiple overlays
  if (document.getElementById('copyrightOverlay')) return;

  const overlay = document.createElement('div');
  overlay.id = 'copyrightOverlay';
  overlay.textContent = '© 2025 VITOOSH ARTWORKS — All rights reserved.';
  Object.assign(overlay.style, {
    position: 'fixed',
    bottom: '20px',
    left: '50%',
    transform: 'translateX(-50%)',
    background: 'rgba(0, 0, 0, 0.75)',
    color: 'white',
    padding: '10px 20px',
    borderRadius: '8px',
    fontSize: '14px',
    zIndex: '9999',
    opacity: '0',
    transition: 'opacity 0.3s ease',
  });
  document.body.appendChild(overlay);

  // Fade in
  requestAnimationFrame(() => (overlay.style.opacity = '1'));

  // Fade out after 2.5 seconds
  setTimeout(() => {
    overlay.style.opacity = '0';
    setTimeout(() => overlay.remove(), 500);
  }, 2500);
}
</script>

</body>
</html>
